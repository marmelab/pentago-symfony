{% extends 'base.html.twig' %}

{% block title %}Play to Pentago !
{% endblock %}

{% block stylesheets %}
	{{ parent() }}

	<link href="{{ asset('css/game.css') }}" rel="stylesheet"/>
	<link href="{{ asset('css/waiting_opponent.css') }}" rel="stylesheet"/>
{% endblock %}

{% block body %}

	{% if status == constant('App\\Service\\GameService::GAME_WAITING_OPPONENT') %}
		{% include 'game/waiting_opponent.html.twig' %}
	{% else %}
		{% include 'game/board.html.twig' %}
	{% endif %}
{% endblock %}

{% block javascripts %}
	{% if status == constant('App\\Service\\GameService::GAME_WAITING_OPPONENT') or isYourTurn == false and status != constant('App\\Service\\GameService::GAME_FINISHED')%}
		<script>
			// URL is a built-in JavaScript class to manipulate URLs
			const url = new URL("{{ MERCURE_PUBLISH_URL }}");
			url.searchParams.append('topic', '{{ app.request.uri }}');

			const eventSource = new EventSource(url);
			eventSource.onmessage = event => {
				window.location.reload();
			}
		</script>
	{% endif %}

{% endblock %}
